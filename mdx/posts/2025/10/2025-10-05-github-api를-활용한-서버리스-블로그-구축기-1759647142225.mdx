---
title: "ğŸš€GitHub APIë¥¼ í™œìš©í•œ ì„œë²„ë¦¬ìŠ¤ ë¸”ë¡œê·¸ êµ¬ì¶•ê¸°"
date: 2025-10-05 15:52
category: "ì‚¬ì´ë“œ í”„ë¡œì íŠ¸"
tags: ["Next.js", "Git API"]
thumbnail: "https://raw.githubusercontent.com/ParkYongHo1/ParkYongHo.blog/main/mdx/images/1759647142228-c21b8f85-b722-46ce-ba0f-adc95a8ab282.png"
readingTime: "5ë¶„"
---

## ğŸ“š GitHub APIë€?

GitHub APIëŠ” GitHub ì €ì¥ì†Œì˜ íŒŒì¼, ì»¤ë°‹, ë¸Œëœì¹˜ ë“±ì„ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ ì œì–´í•  ìˆ˜ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. ì´ë¥¼ í™œìš©í•˜ë©´ GitHubë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì²˜ëŸ¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ ì—†ì´ ë¸”ë¡œê·¸ë¥¼ ìš´ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ¯ ì´ˆê¸° ì„¤ê³„: ë¶„ì‚°ëœ ë©”íƒ€ë°ì´í„° êµ¬ì¡°

ì²˜ìŒì—ëŠ” ê²€ìƒ‰ ì„±ëŠ¥ì„ ìœ„í•´ ë©”íƒ€ë°ì´í„°ë¥¼ ì¹´í…Œê³ ë¦¬ë³„, íƒœê·¸ë³„, ì—°ë„ë³„ë¡œ ë¶„ë¦¬í•˜ì—¬ ì €ì¥í•˜ëŠ” êµ¬ì¡°ë¥¼ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.
```
// ì´ˆê¸° êµ¬ì¡° - ê° ë©”íƒ€ë°ì´í„°ë¥¼ ê°œë³„ì ìœ¼ë¡œ ì €ì¥
async function createPost(post: PostMetadata) {
  // 1. MDX íŒŒì¼ ì €ì¥
  await githubApi.put(`/repos/${owner}/${repo}/contents/mdx/posts/${fileName}`, {
    message: "Add post",
    content: encodedContent,
    branch: "dev",
  });

  // 2. ì¹´í…Œê³ ë¦¬ ë©”íƒ€ë°ì´í„° ì €ì¥
  await githubApi.put(`/repos/${owner}/${repo}/contents/mdx/metadata/categories/${category}.json`, {
    message: "Update category metadata",
    content: categoryData,
    branch: "dev",
  });

  // 3. íƒœê·¸ë³„ ë©”íƒ€ë°ì´í„° ì €ì¥
  for (const tag of tags) {
    await githubApi.put(`/repos/${owner}/${repo}/contents/mdx/metadata/tags/${tag}.json`, {
      message: `Update tag ${tag}`,
      content: tagData,
      branch: "dev",
    });
  }

  // 4. ì—°ë„ë³„ ë©”íƒ€ë°ì´í„° ì €ì¥
  await githubApi.put(`/repos/${owner}/${repo}/contents/mdx/metadata/yearly/${year}.json`, {
    message: "Update yearly metadata",
    content: yearlyData,
    branch: "dev",
  });
}
```

### âš ï¸ ë¬¸ì œì  ë°œê²¬

ì´ ë°©ì‹ì€ í•˜ë‚˜ì˜ ê¸€ì„ ì‘ì„±í•  ë•Œ ì—¬ëŸ¬ ê°œì˜ ì»¤ë°‹ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íƒœê·¸ê°€ 3ê°œì¸ ê¸€ì„ ì‘ì„±í•˜ë©´:

- ğŸ“„ MDX íŒŒì¼: 1ê°œ ì»¤ë°‹
- ğŸ“ ì¹´í…Œê³ ë¦¬: 1ê°œ ì»¤ë°‹
- ğŸ·ï¸ íƒœê·¸ 3ê°œ: 3ê°œ ì»¤ë°‹
- ğŸ“… ì—°ë„ë³„: 1ê°œ ì»¤ë°‹

**ì´ 6ê°œì˜ ì»¤ë°‹ì´ ìƒì„±ë˜ì–´ Git íˆìŠ¤í† ë¦¬ê°€ ì§€ì €ë¶„í•´ì¡ŒìŠµë‹ˆë‹¤.**

## âœ¨ 1ì°¨ ê°œì„ : GitHub Tree API í™œìš©

ì—¬ëŸ¬ íŒŒì¼ì„ í•œ ë²ˆì˜ ì»¤ë°‹ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•´ Gitì˜ ì €ìˆ˜ì¤€ APIì¸ Tree APIë¥¼ í™œìš©í–ˆìŠµë‹ˆë‹¤.
```
async function createPostWithSingleCommit(
  githubApi: AxiosInstance,
  owner: string,
  repo: string,
  files: FileToCommit[],
  commitMessage: string
) {
  // 1. í˜„ì¬ ë¸Œëœì¹˜ì˜ ìµœì‹  ì»¤ë°‹ SHA ê°€ì ¸ì˜¤ê¸°
  const { data: refData } = await githubApi.get(
    `/repos/${owner}/${repo}/git/ref/heads/dev`
  );
  const latestCommitSha = refData.object.sha;

  // 2. ì»¤ë°‹ì˜ íŠ¸ë¦¬ SHA ê°€ì ¸ì˜¤ê¸°
  const { data: commitData } = await githubApi.get(
    `/repos/${owner}/${repo}/git/commits/${latestCommitSha}`
  );
  const baseTreeSha = commitData.tree.sha;

  // 3. ìƒˆ íŠ¸ë¦¬ ìƒì„± (ëª¨ë“  íŒŒì¼ í¬í•¨)
  const tree = files.map((file) => ({
    path: file.path,
    mode: "100644",
    type: "blob",
    content: file.content,
  }));

  const { data: newTree } = await githubApi.post(
    `/repos/${owner}/${repo}/git/trees`,
    { base_tree: baseTreeSha, tree }
  );

  // 4. ìƒˆ ì»¤ë°‹ ìƒì„±
  const { data: newCommit } = await githubApi.post(
    `/repos/${owner}/${repo}/git/commits`,
    {
      message: commitMessage,
      tree: newTree.sha,
      parents: [latestCommitSha],
    }
  );

  // 5. ë¸Œëœì¹˜ ì°¸ì¡° ì—…ë°ì´íŠ¸
  await githubApi.patch(`/repos/${owner}/${repo}/git/refs/heads/dev`, {
    sha: newCommit.sha,
  });
}
```

### ğŸ‰ê°œì„  íš¨ê³¼

ì´ì œ MDX íŒŒì¼ê³¼ ëª¨ë“  ë©”íƒ€ë°ì´í„° íŒŒì¼ì´ í•˜ë‚˜ì˜ ì»¤ë°‹ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

## ğŸ”„ 2ì°¨ ê°œì„ : ì´ë¯¸ì§€ ì—…ë¡œë“œ í†µí•©

ì´ˆê¸°ì—ëŠ” ì´ë¯¸ì§€ ì—…ë¡œë“œì™€ ê¸€ ì‘ì„±ì„ ë¶„ë¦¬ëœ APIë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
```
// ê¸°ì¡´ ë°©ì‹ - 2ê°œì˜ API, 2ê°œì˜ ì»¤ë°‹

// í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìˆœì°¨ í˜¸ì¶œ
const imageResponse = await axios.post("/api/images", imageFormData);
await axios.post("/api/posts", { 
  title, 
  content, 
  thumbnail: imageResponse.data.url 
});
```

ì´ ë°©ì‹ë„ ì—¬ì „íˆ 2ê°œì˜ ì»¤ë°‹ì´ ìƒì„±ë˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

## ğŸ†ìµœì¢… í•´ê²°: í†µí•© API

ì´ë¯¸ì§€ ì—…ë¡œë“œì™€ ê¸€ ì‘ì„±ì„ í•˜ë‚˜ì˜ APIë¡œ í†µí•©í•˜ê³ , Tree APIë¥¼ í™œìš©í•˜ì—¬ ëª¨ë“  íŒŒì¼ì„ í•œ ë²ˆì— ì»¤ë°‹í•˜ë„ë¡ ê°œì„ í–ˆìŠµë‹ˆë‹¤.
```
export async function POST(request: NextRequest) {
  const formData = await request.formData();
  const title = formData.get("title") as string;
  const content = formData.get("content") as string;
  const thumbnailFile = formData.get("thumbnail") as File | null;

  const files: FileToCommit[] = [];

  // ì´ë¯¸ì§€, MDX, ëª¨ë“  ë©”íƒ€ë°ì´í„°ë¥¼ files ë°°ì—´ì— ì¶”ê°€
  if (thumbnailFile) {
    files.push({ path: `mdx/images/${imageName}`, content: imageContent });
  }
  files.push({ path: mdxPath, content: mdxContent });
  files.push({ path: categoryPath, content: categoryContent });
  // ... íƒœê·¸, ì—°ë„ë³„ ë©”íƒ€ë°ì´í„°

  // ëª¨ë“  íŒŒì¼ì„ í•œ ë²ˆì˜ ì»¤ë°‹ìœ¼ë¡œ ì €ì¥
  await commitFilesToGitHub(githubApi, owner, repo, files, `Add post: ${title}`);
}
```

## ğŸ“Šê²°ê³¼ ë¹„êµ

| ë°©ì‹ | ì»¤ë°‹ ê°œìˆ˜ | ë¬¸ì œì  |
|------|-----------|--------|
| ì´ˆê¸° (ê°œë³„ ì €ì¥) | 6ê°œ âŒ | Git íˆìŠ¤í† ë¦¬ ì§€ì €ë¶„ |
| 1ì°¨ ê°œì„  (Tree API) | 2ê°œ âš ï¸ | ì´ë¯¸ì§€ì™€ ê¸€ì´ ë¶„ë¦¬ |
| ìµœì¢… (í†µí•© API) | 1ê°œ âœ… | í•´ê²° ì™„ë£Œ |

## ğŸ˜€ê²°ê³¼

![ë¶™ì—¬ë„£ì€ ì´ë¯¸ì§€](temp-1759647086920-02ee7534-4d47-4cf8-9a09-083e3f7e04a8)
